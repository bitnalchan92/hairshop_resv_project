# 멀티테넌트 예약 플랫폼 PRD v2.0

## 1. 프로젝트명
**예약이 필요한 개인사업자를 위한 맞춤형 예약 홈페이지 SaaS 플랫폼**

---

## 2. 문제정의 (Why)

### 2.1 현재 문제점
- 소규모 개인사업자(미용실, 필라테스, 네일샵 등)는 예약 시스템이 필요하지만, 자체 웹사이트 구축 및 유지보수 비용이 부담스럽다
- 기존 예약 플랫폼(네이버 예약, 카카오톡 등)은 높은 수수료를 부과한다
- 개인사업자마다 브랜드 정체성과 서비스 특성이 다르지만, 획일화된 템플릿만 제공받는다

### 2.2 솔루션
- 사장님별로 **커스터마이징된 랜딩페이지**를 제공하는 SaaS 플랫폼
- **호스팅, 도메인 연결, 유지보수**를 포함한 올인원 서비스
- 저렴한 월 구독료로 자신만의 예약 홈페이지를 운영할 수 있도록 지원

---

## 3. 목표 및 성공 지표

### 3.1 목표
1. 다양한 업종의 개인사업자에게 **맞춤형 예약 홈페이지**를 제공
2. 플랫폼 관리자가 효율적으로 **여러 사장님을 관리**할 수 있는 어드민 시스템 구축
3. **확장 가능한 멀티테넌트 아키텍처** 설계로 유지보수 용이성 확보
4. 고객(손님)에게는 **간편하고 직관적인 예약 경험** 제공

### 3.2 성공 지표
- **Phase 1 (6개월)**: 도봉구 방학동 내 활성 스토어 20개 확보
- **Phase 2 (12개월)**: 활성 스토어 100개 확보, 월 구독 매출 500만원 달성
- **평균 고객 이탈률 (Churn Rate)**: 월 10% 이하 유지
- **사장님 만족도**: NPS 점수 50+ 달성

---

## 4. 사용자 역할 및 권한

### 4.1 플랫폼 관리자 (Platform Admin - 당신)
**역할**: 전체 플랫폼 운영 및 사장님 관리

**핵심 기능**:
- 새로운 사장님(테넌트) 등록 및 관리
- 사장님별 랜딩페이지 커스터마이징 (색상, 로고, 레이아웃 등)
- 사장님별 도메인 연결 및 호스팅 관리
- 전체 예약 현황 및 매출 대시보드 모니터링
- 사장님별 구독 상태 및 결제 관리
- 시스템 전반 설정 및 유지보수

### 4.2 사장님 (Tenant - 미용실/필라테스/네일샵 등 사업자)
**역할**: 자신의 스토어 및 예약 관리

**핵심 기능**:
- 본인 스토어의 영업일/휴무일 설정
- 서비스(상품) 등록 및 관리 (컷, 펌, 1:1 PT 수업 등)
- 서비스별 가격, 소요시간, 설명 입력
- 예약 가능 시간대 설정
- 고객 예약 수락/거절/취소
- 결제 현황 및 정산 내역 확인
- 고객 관리 (예약 히스토리, 메모 등)
- 본인 랜딩페이지 미리보기

### 4.3 고객 (Customer - 서비스를 예약하는 손님)
**역할**: 서비스 예약 및 결제

**핵심 기능**:
- 사장님의 커스텀 랜딩페이지 접속
- 서비스(상품) 검색 및 확인
- 예약 가능한 일자 및 시간 선택
- 예약 및 결제 진행
- 예약 내역 확인
- 예약 취소 및 환불 요청 (정책 범위 내)

---

## 5. 핵심 사용자 스토리 (What)

### 5.1 플랫폼 관리자 사용자 스토리
1. **사장님 등록**: "새로운 사장님을 등록하고, 업종(미용실/필라테스/네일샵 등)을 선택할 수 있다"
2. **랜딩페이지 커스터마이징**: "사장님의 브랜드에 맞게 색상 테마, 로고, 헤더 이미지를 설정할 수 있다"
3. **도메인 연결**: "사장님에게 서브도메인(예: jimin-salon.myplatform.com) 또는 커스텀 도메인을 연결해줄 수 있다"
4. **대시보드 모니터링**: "모든 사장님의 예약 현황, 매출, 활성 상태를 한눈에 볼 수 있다"
5. **구독 관리**: "사장님별 구독 플랜, 결제 상태, 만료일을 관리할 수 있다"

### 5.2 사장님(테넌트) 사용자 스토리
1. **영업일 관리**: "365일 중 원하는 영업일과 휴무일을 선택하고, 특정 날짜의 영업 시간을 조정할 수 있다"
2. **서비스 등록**: "내가 제공하는 서비스(컷, 펌, 염색 등)를 등록하고 가격, 소요시간, 설명을 입력할 수 있다"
3. **예약 시간 설정**: "30분/1시간 단위로 예약 가능한 시간 슬롯을 설정할 수 있다"
4. **예약 알림**: "손님이 예약 및 결제를 완료하면 모바일/데스크탑으로 즉시 알림을 받는다"
5. **예약 관리**: "예약을 수락/거절할 수 있고, 필요시 예약을 취소할 수 있다"
6. **정산 확인**: "결제 완료된 예약 목록과 정산 예정 금액을 확인할 수 있다"
7. **내 페이지 확인**: "고객이 보는 내 랜딩페이지를 미리보기로 확인할 수 있다"

### 5.3 고객 사용자 스토리
1. **서비스 탐색**: "사장님의 랜딩페이지에 접속하여 제공되는 서비스 목록과 가격을 확인할 수 있다"
2. **서비스 선택**: "원하는 서비스를 선택하고 상세 정보를 볼 수 있다"
3. **일자 선택**: "캘린더에서 예약 가능한 날짜를 확인하고 선택할 수 있다"
4. **시간 선택**: "선택한 날짜의 예약 가능한 시간대를 확인하고 원하는 시간을 선택할 수 있다"
5. **예약 확정**: "선택한 서비스, 날짜, 시간을 확인하고 예약을 진행할 수 있다"
6. **결제**: "안전한 결제 수단(카드, 간편결제 등)으로 결제를 완료할 수 있다"
7. **예약 확인**: "예약 완료 후 예약 상세 정보를 확인하고 문자/이메일로 예약 확인서를 받는다"
8. **예약 취소**: "정책에 따라 예약을 취소하고 전액 또는 부분 환불을 요청할 수 있다"

---

## 6. 핵심 디자인 원칙 및 사용자 흐름 (How)

### 6.1 디자인 원칙

#### 6.1.1 모바일 우선 (Mobile-First)
- 모든 핵심 기능은 스마트폰에서 완벽하게 작동해야 함
- 터치 인터페이스에 최적화된 UI/UX

#### 6.1.2 멀티테넌시 아키텍처
- 하나의 코드베이스로 여러 사장님에게 서비스 제공
- 사장님별 데이터 완전 격리 (Data Isolation)
- 확장 가능한 데이터베이스 스키마

#### 6.1.3 화이트라벨링 (White-labeling)
- 사장님별로 브랜드 아이덴티티 반영 가능
- 색상, 로고, 폰트 등 커스터마이징 가능
- 고객은 특정 사장님의 "전용 사이트"로 인식

#### 6.1.4 유지보수 용이성
- 코드 변경 시 모든 테넌트에 자동 반영
- 중앙화된 배포 및 모니터링
- 로그 및 에러 추적 시스템

### 6.2 핵심 사용자 흐름

#### 6.2.1 플랫폼 관리자 흐름
```
관리자 로그인
  ↓
대시보드 (전체 현황)
  ↓
사장님 관리
  ├─ 신규 사장님 등록
  ├─ 랜딩페이지 커스터마이징
  ├─ 도메인 설정
  └─ 구독 관리
  ↓
모니터링 (예약/매출/에러)
```

#### 6.2.2 사장님 흐름
```
사장님 로그인
  ↓
내 스토어 대시보드
  ↓
초기 설정 (최초 1회)
  ├─ 스토어 정보 입력
  ├─ 서비스 등록
  └─ 영업 시간 설정
  ↓
일상 운영
  ├─ 예약 확인 및 수락
  ├─ 서비스 수정
  ├─ 휴무일 설정
  └─ 정산 내역 확인
```

#### 6.2.3 고객 흐름 (기존 PRD 유지)
```
랜딩페이지 접속 (예: jimin-salon.myplatform.com)
  ↓
서비스 탐색 및 선택
  ↓
예약 일자 선택 (캘린더)
  ↓
예약 시간 선택 (타임슬롯)
  ↓
예약자 정보 입력
  ↓
주문/결제 페이지
  ↓
결제 완료 및 예약 확정
  ↓
예약 확인서 수신 (SMS/이메일)
```

---

## 7. 기술 스택 및 아키텍처 (How)

### 7.1 멀티테넌시 전략
**선택 옵션**:
1. **서브도메인 방식** (추천): `{tenant-id}.myplatform.com`
   - 장점: 사장님별 독립적인 URL, SEO 유리
   - 단점: SSL 인증서 관리 필요

2. **경로 기반 방식**: `myplatform.com/{tenant-id}`
   - 장점: 간단한 구현
   - 단점: 브랜딩 약함

### 7.2 데이터베이스 설계 원칙
- **공유 데이터베이스 + 테넌트 ID 분리** 방식 채택
- 모든 주요 테이블에 `tenant_id` 컬럼 추가
- Row-Level Security (RLS) 적용으로 데이터 격리 보장

### 7.3 예상 기술 스택
**Frontend**:
- Next.js (App Router)
- React
- TailwindCSS
- TypeScript

**Backend**:
- Next.js API Routes 또는 NestJS
- PostgreSQL (멀티테넌시 지원)
- Prisma ORM

**인프라**:
- Vercel 또는 AWS (호스팅)
- PostgreSQL (Supabase 또는 RDS)
- Redis (캐싱/세션)

**결제**:
- 포트원(PortOne) 또는 토스페이먼츠

---

## 8. 주요 기능 명세 (Features)

### 8.1 플랫폼 관리자 어드민

#### 8.1.1 사장님 관리
- [ ] 사장님 등록/수정/삭제 (CRUD)
- [ ] 업종 선택 (미용실, 필라테스, 네일샵, 기타)
- [ ] 사장님 정보: 상호명, 연락처, 주소, 사업자번호
- [ ] 계정 상태 관리 (활성/비활성/정지)

#### 8.1.2 랜딩페이지 커스터마이징
- [ ] 색상 테마 설정 (Primary, Secondary, Background)
- [ ] 로고 업로드
- [ ] 헤더 배너 이미지 업로드
- [ ] 폰트 선택
- [ ] 레이아웃 템플릿 선택 (미용실형, PT형, 네일형 등)

#### 8.1.3 도메인 관리
- [ ] 서브도메인 자동 할당 (`{tenant-slug}.myplatform.com`)
- [ ] 커스텀 도메인 연결 지원 (추후)
- [ ] SSL 인증서 자동 발급

#### 8.1.4 대시보드
- [ ] 전체 사장님 수, 활성 사장님 수
- [ ] 총 예약 수, 이번 달 예약 수
- [ ] 총 매출, 이번 달 매출
- [ ] 사장님별 예약/매출 순위

#### 8.1.5 구독 및 결제 관리
- [ ] 사장님별 구독 플랜 (무료체험, 베이직, 프리미엄 등)
- [ ] 구독 시작일/만료일 관리
- [ ] 자동 결제 및 청구서 발송
- [ ] 미납 시 알림 및 서비스 정지

### 8.2 사장님(테넌트) 어드민

#### 8.2.1 스토어 설정
- [ ] 스토어 기본 정보 (상호명, 주소, 연락처, 소개)
- [ ] 대표 이미지 업로드
- [ ] 영업 시간 설정 (요일별)
- [ ] 휴무일 캘린더 설정

#### 8.2.2 서비스(상품) 관리
- [ ] 서비스 등록/수정/삭제
- [ ] 서비스명, 가격, 소요시간, 설명, 이미지
- [ ] 카테고리 분류 (컷, 펌, 염색 등)
- [ ] 서비스별 활성/비활성 상태

#### 8.2.3 예약 관리
- [ ] 예약 목록 (대기/확정/완료/취소)
- [ ] 예약 상세 정보 (고객 정보, 서비스, 날짜/시간)
- [ ] 예약 수락/거절
- [ ] 예약 취소 및 환불 처리
- [ ] 예약 알림 (웹/모바일 푸시, 이메일, SMS)

#### 8.2.4 고객 관리
- [ ] 고객 목록 (이름, 연락처, 예약 횟수)
- [ ] 고객별 예약 히스토리
- [ ] 고객 메모 기능

#### 8.2.5 정산 및 매출
- [ ] 일별/주별/월별 매출 통계
- [ ] 예약별 결제 상태 (결제 완료/환불 완료)
- [ ] 정산 예정 금액 확인

#### 8.2.6 내 페이지 미리보기
- [ ] 고객이 보는 랜딩페이지 미리보기
- [ ] 반응형 미리보기 (모바일/태블릿/데스크탑)

### 8.3 고객 예약 페이지

#### 8.3.1 랜딩페이지
- [ ] 사장님 맞춤형 브랜딩 (로고, 색상, 배너)
- [ ] 스토어 소개 섹션
- [ ] 서비스 목록 카드형 레이아웃
- [ ] 영업 시간 및 위치 정보

#### 8.3.2 서비스 선택
- [ ] 서비스 카테고리 필터
- [ ] 서비스 카드 (이미지, 이름, 가격, 소요시간)
- [ ] 서비스 상세 모달/페이지

#### 8.3.3 예약 일자 선택
- [ ] 캘린더 UI
- [ ] 예약 가능한 날짜 표시 (영업일만)
- [ ] 휴무일 비활성화
- [ ] 이미 예약이 꽉 찬 날짜 표시

#### 8.3.4 예약 시간 선택
- [ ] 선택한 날짜의 가능한 시간 슬롯 표시
- [ ] 30분/1시간 단위 타임슬롯
- [ ] 이미 예약된 시간 비활성화
- [ ] 서비스 소요시간 고려한 슬롯 표시

#### 8.3.5 예약자 정보 입력
- [ ] 이름, 연락처(전화번호), 이메일
- [ ] 요청사항 메모 (선택)

#### 8.3.6 주문/결제
- [ ] 예약 요약 (서비스, 날짜, 시간, 금액)
- [ ] 결제 수단 선택 (카드, 간편결제 등)
- [ ] 환불 정책 안내
- [ ] 개인정보 처리 방침 동의

#### 8.3.7 예약 완료
- [ ] 예약 확정 메시지
- [ ] 예약 번호 발급
- [ ] 예약 확인서 (SMS/이메일 발송)
- [ ] 내 예약 확인 링크

#### 8.3.8 내 예약 조회
- [ ] 예약 번호 또는 전화번호로 조회
- [ ] 예약 상세 정보 확인
- [ ] 예약 취소 기능 (정책 범위 내)

---

## 9. 데이터베이스 ERD 설계 (초안)

### 9.1 핵심 엔티티

#### Platform Admin (플랫폼 관리자)
```
admins
- id (PK)
- email (unique)
- password_hash
- name
- created_at
- updated_at
```

#### Tenant (사장님/스토어)
```
tenants
- id (PK)
- slug (unique) // URL용: jimin-salon
- business_name // 상호명
- business_type // 미용실, 필라테스, 네일샵 등
- owner_name
- owner_email (unique)
- owner_phone
- password_hash
- address
- business_registration_number
- subscription_plan // 무료, 베이직, 프리미엄
- subscription_status // 활성, 정지, 만료
- subscription_start_date
- subscription_end_date
- status // 활성, 비활성, 정지
- created_at
- updated_at
```

#### Tenant Branding (사장님 브랜딩 설정)
```
tenant_brandings
- id (PK)
- tenant_id (FK -> tenants)
- logo_url
- banner_image_url
- primary_color
- secondary_color
- background_color
- font_family
- layout_template // 미용실형, PT형, 네일형
- created_at
- updated_at
```

#### Store Info (스토어 정보)
```
store_infos
- id (PK)
- tenant_id (FK -> tenants, unique)
- description // 스토어 소개
- address_detail
- phone
- opening_hours_json // { "mon": "09:00-18:00", "tue": "09:00-18:00", ... }
- created_at
- updated_at
```

#### Service (서비스/상품)
```
services
- id (PK)
- tenant_id (FK -> tenants)
- category // 컷, 펌, 염색 등
- name
- description
- price (decimal)
- duration_minutes // 소요시간
- image_url
- is_active // 활성/비활성
- display_order // 정렬 순서
- created_at
- updated_at
```

#### Holiday (휴무일)
```
holidays
- id (PK)
- tenant_id (FK -> tenants)
- holiday_date (date)
- reason // 휴무 사유 (선택)
- created_at
```

#### Booking (예약)
```
bookings
- id (PK)
- tenant_id (FK -> tenants)
- service_id (FK -> services)
- customer_name
- customer_phone
- customer_email
- booking_date (date)
- booking_time (time)
- duration_minutes
- status // pending(대기), confirmed(확정), completed(완료), cancelled(취소)
- total_price (decimal)
- payment_status // pending, paid, refunded
- payment_id // 결제 시스템 연동 ID
- special_request // 고객 요청사항
- cancelled_at
- cancelled_by // customer, tenant, admin
- created_at
- updated_at
```

#### Payment (결제)
```
payments
- id (PK)
- tenant_id (FK -> tenants)
- booking_id (FK -> bookings, unique)
- amount (decimal)
- payment_method // 카드, 간편결제 등
- payment_gateway // 포트원, 토스페이먼츠 등
- transaction_id // PG사 거래 ID
- status // pending, completed, failed, refunded
- paid_at
- refunded_at
- refund_amount (decimal)
- created_at
- updated_at
```

#### Customer (고객 - 선택적)
```
customers
- id (PK)
- tenant_id (FK -> tenants)
- name
- phone (unique per tenant)
- email
- total_bookings // 총 예약 횟수
- memo // 사장님 메모
- created_at
- updated_at
```

#### Notification (알림)
```
notifications
- id (PK)
- tenant_id (FK -> tenants)
- booking_id (FK -> bookings)
- type // booking_created, booking_confirmed, booking_cancelled
- message
- is_read
- created_at
```

### 9.2 ERD 관계도 요약
```
admins (1) ──관리──> (N) tenants
tenants (1) ──소유──> (1) tenant_brandings
tenants (1) ──소유──> (1) store_infos
tenants (1) ──소유──> (N) services
tenants (1) ──소유──> (N) holidays
tenants (1) ──소유──> (N) bookings
tenants (1) ──소유──> (N) customers
bookings (N) ──선택──> (1) services
bookings (1) ──연결──> (1) payments
bookings (1) ──생성──> (N) notifications
```

### 9.3 확장 고려사항
- **테넌트 격리**: 모든 주요 테이블에 `tenant_id` 인덱스 추가
- **성능**: `(tenant_id, booking_date)` 복합 인덱스
- **캐싱**: Redis로 예약 가능 시간 슬롯 캐싱
- **확장성**: 향후 리뷰, 쿠폰, 포인트 테이블 추가 가능

---

## 10. 개발 우선순위 및 로드맵

### Phase 1: MVP (4-6주)
**목표**: 단일 사장님으로 핵심 예약 플로우 검증

1. ✅ 프로젝트 세팅 (Next.js + PostgreSQL)
2. ✅ 데이터베이스 스키마 구축
3. 🔲 고객 예약 페이지 (서비스 선택 → 날짜/시간 선택 → 결제)
4. 🔲 결제 연동 (포트원/토스페이먼츠)
5. 🔲 사장님 어드민 (예약 목록, 수락/거절)
6. 🔲 테스트 배포 (1개 스토어)

### Phase 2: 멀티테넌시 (4-6주)
**목표**: 여러 사장님 지원 가능한 구조로 확장

1. 🔲 Tenant 모델 및 브랜딩 시스템 구축
2. 🔲 서브도메인 라우팅 구현
3. 🔲 플랫폼 관리자 어드민 페이지
4. 🔲 사장님 등록 및 랜딩페이지 커스터마이징
5. 🔲 테넌트별 데이터 격리 검증
6. 🔲 3-5개 스토어 파일럿 테스트

### Phase 3: 운영 안정화 (2-4주)
**목표**: 실제 운영 가능한 수준으로 완성도 향상

1. 🔲 알림 시스템 (SMS, 이메일, 푸시)
2. 🔲 환불 및 예약 취소 정책 구현
3. 🔲 에러 모니터링 및 로깅 (Sentry 등)
4. 🔲 성능 최적화 (캐싱, 인덱스)
5. 🔲 모바일 반응형 UI 최적화
6. 🔲 보안 강화 (Rate Limiting, CSRF 방지)

### Phase 4: 성장 기능 (추후)
1. 🔲 리뷰 및 평점 시스템
2. 🔲 쿠폰 및 프로모션
3. 🔲 단골 고객 관리 (CRM)
4. 🔲 커스텀 도메인 지원
5. 🔲 다국어 지원
6. 🔲 모바일 앱 (React Native)

---

## 11. 비기능적 요구사항

### 11.1 성능
- 페이지 로딩 시간 3초 이내 (모바일 4G 환경)
- 예약 완료 프로세스 10초 이내
- 동시 접속자 1000명 처리 가능

### 11.2 보안
- HTTPS 필수
- SQL Injection, XSS 방어
- CSRF 토큰 사용
- 비밀번호 bcrypt 암호화
- PCI DSS 준수 (결제 정보)

### 11.3 확장성
- 테넌트 100개까지 단일 서버 지원
- 수평 확장 가능한 아키텍처 (DB Read Replica)
- CDN 활용 (이미지, 정적 파일)

### 11.4 모니터링
- 에러 로그 수집 (Sentry)
- 성능 모니터링 (Vercel Analytics)
- 예약/결제 성공률 추적

---

## 12. 위험 요소 및 대응 방안

### 12.1 위험 요소
1. **복잡도 증가**: 멀티테넌시 구조로 인한 개발 복잡도
2. **데이터 격리 실패**: 사장님 간 데이터 유출 위험
3. **성능 저하**: 테넌트 수 증가 시 성능 문제
4. **결제 문제**: PG사 연동 오류, 환불 처리 지연

### 12.2 대응 방안
1. **복잡도**: Phase 1에서 단일 테넌트로 검증 후 확장
2. **데이터 격리**: Row-Level Security (RLS) 적용, 철저한 테스트
3. **성능**: 캐싱 전략, DB 인덱스 최적화, 모니터링
4. **결제**: Sandbox 환경에서 충분한 테스트, 장애 대응 매뉴얼

---

## 13. 다음 단계 (Next Steps)

### 즉시 진행 사항
1. ✅ **PRD 검토 및 승인** ← 현재 단계
2. 🔲 **ERD 상세 설계 및 확정**
3. 🔲 **와이어프레임 제작** (Figma 등)
4. 🔲 **기술 스택 최종 확정**
5. 🔲 **개발 환경 세팅**

### 검토 필요 사항
- [ ] 구독 플랜 가격 정책 (무료 체험 기간, 월 구독료 등)
- [ ] 결제 수수료 정책 (플랫폼이 수수료 부담? 사장님 부담?)
- [ ] 환불 정책 (예약 취소 시점별 환불 비율)
- [ ] 초기 타겟 업종 우선순위 (미용실 먼저? 다업종 동시?)
- [ ] 도메인 전략 (서브도메인만? 커스텀 도메인도 제공?)

---

## 14. 질문 및 의사결정 필요 사항

1. **우선 타겟 업종**: 미용실만 먼저 집중 vs 다업종 동시 진행?
2. **구독 모델**: 월 정액제? 예약당 수수료? 하이브리드?
3. **결제 수수료**: 플랫폼이 부담 vs 사장님이 부담?
4. **초기 기능 범위**: MVP에 꼭 필요한 기능만? 아니면 풍부한 기능?
5. **디자인 커스터마이징 수준**: 색상/로고만? 아니면 레이아웃까지?

---

**문서 버전**: v2.0
**작성일**: 2025-12-23
**다음 리뷰**: ERD 확정 후
